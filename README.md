# 書籍レビューアプリ

[アプリのデモはこちらから](https://book-review-frontend-pearl.vercel.app)

## アプリの説明

自分の読んだ書籍のレビューを他のユーザーと共有できるアプリです。

## 作成背景

- バックエンドを自分の力で実装して、理解を深めたいと思ったから。

    - このアプリはフロントエンドを実装するというプログラミングスクールからの課題として取り組んだのですが、バックエンドはスクール側が実装してくれていました。そこで、自分でもフロントエンドの実装だけでなくバックエンドの実装をして理解を深めたいと思い作成しました。

- 自分で作っている中で「こうすればもっと使いやすくなるのでは？」と思う部分があったから。

## 工夫点

- フロントエンド

    - ホームページのタイトル一覧、特定の幅まで文字がたどり着いたら末尾を「...」に置き換えるようにして、見やすくしました。
    - トークンが無い、もしくは無効な状態でトークンが必要なページにアクセスするとエラーページを表示させ、ログインを促すようにしました。
    - 書籍の作成画面と更新画面のUIがほとんど同じなので、1つのコンポーネントに共通化しました。
    - レスポンシブの対応をして、スマホでもアプリを操作できるようにしました

- バックエンド

    - Eloquentやファサードを積極的に使うようにしました。
    - ぺジネーションを実装することで、書籍レビュー一覧取得のレスポンスタイムを軽減しました
    - PHPは動的型付け言語なので、タイプヒンティングやdeclare(strict_types=1);を書いて、厳格なクラス設計にしました。
    - APIが正しく動作しているか確認するテストコードを書きました。
    - メソッドチェーンが長くなってしまった箇所をスコープに移して定義することで可読性を向上しました。
    - レスポンスのjsonのUnescape処理をミドルウェアに任せるようにしました。
 
## 苦労点

- フロントエンド

    - コンポーネントの分け方に困った。
    - CORSの設定につまづいた。
  
- バックエンド

    - テストケースの書き方に苦労しました。（どのassertを使うか？など）
    - 信頼できる情報にたどり着くまでのプロセスに苦労しました。（最近はドキュメントから調べものをスタートするようにしてる）
    - データベースの設計。（正規化するところはする等）
    - 書籍のレビュワーが書いたコメントなのか判定する処理と、自分が書いたコメントなのか判定する処理の実装に困りました。最終的にはコメントを格納するデータベースにレビュワーが書いたコメントか判定するためのフラグを作成するようにしました。

## 課題
- 認証に使うトークンの有効期限が一日と長めに設定しているので、リフレッシュトークンを使用してトークンを短い期間で再発行できるようにし、流出の際のリスクを減らせるようにする。
- 一日の終わりに期限が切れたトークンをデータベースから削除する
- テストコードを書いたが、してほしくない挙動、例えばアクセストークンがない状態でアクセストークンが必要なAPIにアクセスしたときに401エラーが返ってくる等を確認するテストが書けていない。
